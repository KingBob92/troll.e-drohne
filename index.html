<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <title>TROLL.e – Drohnen-Andocken</title>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
  <style>
    html,body{margin:0;background:#0b0e18;color:#e8f0ff;font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif}
    body{overflow:auto;-webkit-tap-highlight-color:transparent}
    #page{display:flex;flex-direction:column;min-height:100svh}
    #stageWrap{display:grid;place-items:center}
    #stage{position:relative;width:1536px;height:1024px;touch-action:none}
    canvas{display:block;width:100%;height:100%}
    .overlay{position:absolute;left:0;right:0;pointer-events:none}
    #uiTop{top:12px;display:flex;justify-content:space-between;gap:12px;padding:0 16px;align-items:center}
    .stack{display:flex;gap:12px;align-items:center}
    .chip{pointer-events:auto;padding:6px 10px;background:#151a2c;border:1px solid #2a3355;border-radius:8px}
    .bar{position:relative;width:260px;height:14px;background:#1a2140;border:1px solid #2a3355;border-radius:8px;overflow:hidden}
    .bar>span{position:absolute;left:0;top:0;bottom:0;width:100%;background:#6bffb0}
    #subtitle{bottom:12px;text-align:center;padding:6px 10px;margin:0 16px;background:#101424;border:1px solid #28304e;border-radius:8px;min-height:2.2em}
    #start,#end{position:absolute;inset:0;display:flex;align-items:center;justify-content:center}
    #end{display:none}
    .panel{pointer-events:auto;background:#0f1322cc;border:1px solid #2a3355;border-radius:12px;padding:18px 20px;text-align:center;box-shadow:0 4px 24px #0008;max-width:680px}
    button{appearance:none;border:1px solid #2a3355;background:#161b30;color:#e8f0ff;padding:10px 14px;border-radius:10px;font-weight:600;cursor:pointer}
    button:hover{filter:brightness(1.07)}
    /* Mobile Controls */
    #controlsOverlay{position:absolute;inset:0;pointer-events:none;display:none}
    .ctrl-left{position:absolute;left:14px;bottom:14px;pointer-events:auto}
    .ctrl-right{position:absolute;right:14px;bottom:14px;display:flex;flex-direction:column;gap:12px;pointer-events:auto}
    .joy{position:relative;width:150px;height:150px}
    .joy .base{position:absolute;inset:0;border-radius:50%;border:2px solid #2a3355;background:radial-gradient(#0e1430aa,#0e143022)}
    .joy .knob{position:absolute;width:56px;height:56px;border-radius:50%;border:2px solid #6b8cff;background:#1d2547cc;transform:translate(-50%,-50%)}
    .bigBtn{min-width:120px;min-height:50px;border-radius:12px;background:#1a2140;border:2px solid #2a3355}
    #controlsBar{display:none;align-items:center;justify-content:space-between;gap:20px;padding:10px 14px;margin:8px auto 14px;max-width:1000px;width:clamp(300px,96vw,1000px)}
    @media (pointer:coarse) and (orientation:landscape){#controlsOverlay{display:block}#controlsBar{display:none}}
    @media (pointer:coarse) and (orientation:portrait){#controlsOverlay{display:none}#controlsBar{display:flex}}
    @media (pointer:coarse){.bar{width:200px}}
    /* Hit-Tint/Haptik-Fallback */
    #hitTint{position:absolute;inset:0;pointer-events:none;background:rgba(255,90,90,0.12);opacity:0;transition:opacity .14s}
    #hitTint.show{opacity:1}
    .shake{animation:sh 120ms linear 1}
    @keyframes sh{0%{transform:translate(0,0)}25%{transform:translate(2px,0)}50%{transform:translate(-2px,0)}75%{transform:translate(1px,0)}100%{transform:translate(0,0)}}
  </style>
</head>
<body>
<div id="page">
  <div id="stageWrap">
    <div id="stage">
      <canvas id="game" width="1536" height="1024"></canvas>
      <div id="uiTop" class="overlay">
        <div class="stack">
          <div class="chip">Zeit: <span id="time">02:00</span></div>
          <div class="chip">Ziel: <span id="goal">Anker finden → Andocken</span></div>
        </div>
        <div class="stack">
          <div class="chip">Health: <span id="hpText">100%</span></div>
          <div class="bar"><span id="hpBar"></span></div>
        </div>
      </div>
      <div id="subtitle" class="overlay"></div>
      <div id="hitTint"></div>

      <div id="start">
        <div class="panel">
          <h2>Drohneneinsatz – Andockmanöver</h2>
          <p id="howto">WASD/←↑→↓ bewegen, <b>Shift</b> Boost, <b>E</b> Dock-Versuch.</p>
          <button id="btnStart">Start</button>
        </div>
      </div>

      <div id="end">
        <div class="panel">
          <h2 id="endTitle">Ende</h2>
          <p id="endMsg"></p>
          <button id="btnRetry">Nochmal</button>
        </div>
      </div>

      <!-- Landscape touch: overlay controls -->
      <div id="controlsOverlay">
        <div class="ctrl-left">
          <div class="joy" id="joy_land">
            <div class="base"></div>
            <div class="knob" id="knob_land"></div>
          </div>
        </div>
        <div class="ctrl-right">
          <button class="bigBtn" id="boost_land">Boost</button>
          <button class="bigBtn" id="dock_land">Andocken</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Portrait touch: controls below canvas -->
  <div id="controlsBar">
    <div class="joy" id="joy_port">
      <div class="base"></div>
      <div class="knob" id="knob_port"></div>
    </div>
    <div style="display:flex;gap:12px">
      <button class="bigBtn" id="boost_port">Boost</button>
      <button class="bigBtn" id="dock_port">Andocken</button>
    </div>
  </div>
</div>

<!-- Scripts -->
<script type="module" src="src/game.js"></script>

</body>
</html>
